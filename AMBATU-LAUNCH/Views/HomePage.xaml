<Page
    x:Class="AMBATU_LAUNCH.Views.HomePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:AMBATU_LAUNCH.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" Padding="12" Spacing="12">
            <Button Content="Add App" Click="AddApp_Click" />
            <TextBox x:Name="SearchBox" 
                     PlaceholderText="Search apps..." 
                     Width="200" 
                     VerticalAlignment="Center" 
                     TextChanged="SearchBox_TextChanged"/>
            <TextBlock Text="Icon Size:" VerticalAlignment="Center" Margin="12,0,0,0"/>
            <Slider x:Name="IconSizeSlider"
                    Minimum="50"
                    Maximum="200"
                    Value="100"
                    Width="200"
                    ValueChanged="IconSizeSlider_ValueChanged" />
        </StackPanel>

        <GridView Grid.Row="1"
                  x:Name="AppGrid"
                  Padding="12"
                  IsItemClickEnabled="True"
                  ItemClick="AppGrid_ItemClick"
                  SelectionMode="None">
            <GridView.ItemTemplate>
                <DataTemplate>
                    <Grid Width="{Binding ElementName=IconSizeSlider, Path=Value}" 
                          Height="{Binding ElementName=IconSizeSlider, Path=Value}"
                          Background="Transparent"
                          CornerRadius="8"
                          Margin="4"
                          Padding="8">
                        <!-- We use a background brush to enable hover effects via visual states if we add them, or just let WinUI's default grid view item styling handle the hover natively -->
                        <Grid.ContextFlyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="Rename" Click="RenameApp_Click">
                                    <MenuFlyoutItem.Icon>
                                        <SymbolIcon Symbol="Rename"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Move to Category..." Click="MoveToCategory_Click">
                                    <MenuFlyoutItem.Icon>
                                        <SymbolIcon Symbol="MoveToFolder"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Open File Location" Click="OpenFileLocation_Click">
                                    <MenuFlyoutItem.Icon>
                                        <SymbolIcon Symbol="Folder"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem Text="Remove from Launcher" Click="RemoveApp_Click" Foreground="Red">
                                    <MenuFlyoutItem.Icon>
                                        <SymbolIcon Symbol="Delete"/>
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </Grid.ContextFlyout>
                        
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <Image Grid.Row="0" Source="{Binding Icon}" HorizontalAlignment="Center" VerticalAlignment="Center" Stretch="Uniform" Margin="0,0,0,4"/>
                        <TextBlock Grid.Row="1" Text="{Binding Name}" HorizontalAlignment="Center" TextAlignment="Center" TextTrimming="CharacterEllipsis" MaxLines="2" TextWrapping="Wrap" FontSize="12"/>
                    </Grid>
                </DataTemplate>
            </GridView.ItemTemplate>
        </GridView>

        <TextBlock x:Name="EmptyStateTextBlock"
                   Grid.Row="1"
                   Text="No apps in this category yet. Click 'Add App' to get started!"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Style="{StaticResource SubtitleTextBlockStyle}"
                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                   Visibility="Collapsed"/>
    </Grid>
</Page>
